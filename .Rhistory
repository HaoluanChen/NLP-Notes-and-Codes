news_sentiment
news_sentiment <- news_df %>%
inner_join(get_sentiments("bing"))
news_sentiment <- news_df %>%
inner_join(get_sentiments("bing")) %>%
count(sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
news_sentiment
news_sentiment <- news_df %>%
inner_join(get_sentiments("bing"))
news_sentiment
news_sentiment <- news_df %>%
inner_join(get_sentiments("bing"))
news_sentiment <- news_df %>%
inner_join(get_sentiments("bing")) %>%
count(index = line, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
news_sentiment
ggplot(news_sentiment, aes(index, sentiment, fill = book))
ggplot(news_sentiment, aes(index, sentiment))
ggplot(news_sentiment, aes(index, sentiment)) +]
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)
ggplot(news_sentiment, aes(index, sentiment)) +
scale_x_continuous(name="Lines", limits=c(0, 8))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 8))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 10))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 9))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 12))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 8.5))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 8.9))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 8.7))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c(0, 9))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_continuous(name="Lines", limits=c("2", "4", "6", "8", "10"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(name="Lines", limits=c("2", "4", "6", "8", "10"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(name="Lines", limits=c("2", "4", "6", "8"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(limits=c("0.5", "2")
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(limits=c("0.5", "2"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(limits=c("2", "4"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete(limits=c("2", "8"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
scale_x_discrete()
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0, 20))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0, 12))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0, 10))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0, 8))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0, 4))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,15))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,14))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,13))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,12))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,11))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,12))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,16))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,9))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,8.5))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_continuous(limits = c(0,8.99))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_discrete(limits = c("2", "8"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_discrete(limits = c("0", "2", "4"))
ggplot(news_sentiment, aes(index, sentiment)) +
geom_col(show.legend = FALSE)+ scale_x_discrete(limits = c(0, 2, 4, 6, 8))
afinn <- news %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
nrc <- news_df %>%
inner_join(get_sentiments("nrc")) %>%
filter(sentiment %in% c("positive", "negative")) %>%
mutate(method = "NRC")
nrc
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
nrc <- news_df %>%
inner_join(get_sentiments("nrc")) %>%
filter(sentiment %in% c("positive", "negative")) %>%
mutate(method = "NRC")
nrc
bing_and_nrc <- bind_rows(bing, nrc) %>%
count(method, index = line, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
bind_rows(afinn, bing_and_nrc)
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
nrc <- news_df %>%
inner_join(get_sentiments("nrc")) %>%
filter(sentiment %in% c("positive", "negative")) %>%
mutate(method = "NRC")
nrc
bing_and_nrc <- bind_rows(bing, nrc) %>%
count(method, index = line, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
bing_and_nrc
bind_rows(afinn, bing_and_nrc)
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
nrc <- news_df %>%
inner_join(get_sentiments("nrc")) %>%
filter(sentiment %in% c("positive", "negative")) %>%
mutate(method = "NRC")
nrc
bing_and_nrc <- bind_rows(bing, nrc) %>%
count(method, index = line, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
bing_and_nrc
# plotting
bind_rows(afinn, bing_and_nrc) %>%
ggplot(aes(index, sentiment, fill = method)) +
geom_col() +
facet_wrap(~method, ncol = 1, scales = "free_y")
afinn <- news_df %>%
inner_join(get_sentiments("afinn")) %>%
group_by(index = line) %>%
summarise(sentiment = sum(value)) %>%
mutate(method = "AFINN")
afinn
bing <- news_df %>%
inner_join(get_sentiments("bing")) %>%
mutate(method = "bing")
bing
nrc <- news_df %>%
inner_join(get_sentiments("nrc")) %>%
filter(sentiment %in% c("positive", "negative")) %>%
mutate(method = "NRC")
nrc
bing_and_nrc <- bind_rows(bing, nrc) %>%
count(method, index = line, sentiment) %>%
spread(sentiment, n, fill = 0) %>%
mutate(sentiment = positive - negative)
bing_and_nrc
# plotting
bind_rows(afinn, bing_and_nrc) %>%
ggplot(aes(index, sentiment, fill = method)) +
geom_col() +
facet_wrap(~method, ncol = 1, scales = "free_y") +
scale_x_discrete(limits = c(0, 2, 4, 6, 8))
# plotting
bind_rows(afinn, bing_and_nrc) %>%
ggplot(aes(index, sentiment, fill = method)) +
geom_col() +
facet_wrap(~method, ncol = 1, scales = "free_y") +
scale_x_discrete(limits = c(0, 2, 4, 6, 8, 10, 12, 14, 16))
# plotting
bind_rows(afinn, bing_and_nrc) %>%
ggplot(aes(index, sentiment, fill = method)) +
geom_col() +
facet_wrap(~method, ncol = 1, scales = "free_y") +
scale_x_discrete(limits = c(0, 2, 4, 6, 8, 10, 12))
news2_df %>%
inner_join(nrc_negative) %>%
count(word, sort = TRUE)
nrc_negative <- get_sentiments("nrc") %>%
filter(sentiment == "negative")
news_df %>%
inner_join(nrc_negative) %>%
count(word, sort = TRUE)
news2_df %>%
inner_join(nrc_negative) %>%
count(word, sort = TRUE)
get_sentiments("nrc") %>%
filter(sentiment %in% c("positive",
"negative")) %>%
count(sentiment)
get_sentiments("bing") %>%
count(sentiment)
bing
nrc
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
nrc_word_count
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE) %>%
nrc_word_count
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
nrc_word_count %>%
group_by(sentimen) %>%
mutate(word = reorder(word,n))
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidytext)
library(ggplot2)
library(tidyr)
library(scales)
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
mutate(word = reorder(word,n))
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment)
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
mutate(word = reorder(word,n))
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment)
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
mutate(word = reorder(word,n))
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
ggplot(ase(word,n,fill = sentiment)) +
gemo_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment", x = NULL) +
coord_flip()
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
ggplot(ase(word,n,fill = sentiment)) +
gemo_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment", x = NULL) +
coord_flip()
nrc_word_count <- nrc %>%
count(word, sentiment, sort = TRUE)
nrc_word_count
#plot
nrc_word_count %>%
group_by(sentiment) %>%
ggplot(aes(word,n,fill = sentiment)) +
gemo_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment", x = NULL) +
coord_flip()
nrc_word_count %>%
group_by(sentiment) %>%
ggplot(aes(word,n,fill = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(y = "Contribution to sentiment", x = NULL) +
coord_flip()
library(wordcloud)
library(scales)
install.packages("wordcloud")
nrc %>%
count(word) %>%
with(wordcloud(word, n, max.words = 100))
library(wordcloud)
nrc %>%
count(word) %>%
with(wordcloud(word, n, max.words = 100))
nrc %>%
count(word) %>%
with(wordcloud(word, n))
nrc
library(janeaustenr)
library(dplyr)
library(stringr)
tidy_books <- austen_books() %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",
ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(word, text)
library(janeaustenr)
library(dplyr)
library(stringr)
tidy_books <- austen_books() %>%
group_by(book) %>%
mutate(linenumber = row_number(),
chapter = cumsum(str_detect(text, regex("^chapter [\\divxlc]",
ignore_case = TRUE)))) %>%
ungroup() %>%
unnest_tokens(word, text)
tidy_books %>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 100))
news
news_sentences <- tibble(line = 1:15, text = news)
news_sentences <- news_sentences %>%
unnest_tokens(sentence, text, token = "sentences")
news_sentences <- tibble(line = 1:15, text = news)
news_sentences <- news_sentences %>%
unnest_tokens(sentence, text, token = "sentences")
news_sentences
View(news_sentences)
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
tidy_books %>%
semi_join(bingnegative) %>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/words) %>%
filter(chapter != 0) %>%
top_n(1) %>%
ungroup()
negativewords
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative) %>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/words) %>%
filter(chapter != 0) %>%
top_n(1) %>%
ungroup()
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative) %>%
summarize(negativewords = n()) %>%
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n())
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/words)
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/word)
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n())
news_df
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n())
news_df
words <- count(word)
nrow(news_df)
a <- nrow(news_df)
a
words <- news_df %>%
count(word)
words
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
word_count <- nrow(news_df)
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/word_count)
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
word_count <- nrow(news_df)
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/word_count) %>%
ungroup()
bingnegative <- get_sentiments("bing") %>%
filter(sentiment == "negative")
word_count <- nrow(news_df)
news_df %>%
semi_join(bingnegative)%>%
summarize(negativewords = n()) %>%
mutate(ratio = negativewords/word_count)
